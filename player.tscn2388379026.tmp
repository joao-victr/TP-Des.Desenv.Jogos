[gd_scene load_steps=50 format=3 uid="uid://ctug6agwl6viy"]

[ext_resource type="Texture2D" uid="uid://dd6cbiwdvvsaa" path="res://1-Idle/1.png" id="1_331ug"]
[ext_resource type="Texture2D" uid="uid://ck1grc2t5qyjh" path="res://fundo.png" id="1_ny14h"]
[ext_resource type="Texture2D" uid="uid://com0jdfa5vce5" path="res://1-Idle/2.png" id="2_ny14h"]
[ext_resource type="Texture2D" uid="uid://81dhbva0cbxe" path="res://1-Idle/3.png" id="3_ibah8"]
[ext_resource type="Texture2D" uid="uid://d0270ams2e7g5" path="res://1-Idle/4.png" id="4_3iwfv"]
[ext_resource type="Texture2D" uid="uid://dxlggswqb3421" path="res://1-Idle/5.png" id="5_qwsg1"]
[ext_resource type="Texture2D" uid="uid://dtud6d4yy2td" path="res://1-Idle/6.png" id="6_1xqrm"]
[ext_resource type="Texture2D" uid="uid://bkry5ioangj5p" path="res://1-Idle/7.png" id="7_bfour"]
[ext_resource type="Texture2D" uid="uid://65brey23umen" path="res://1-Idle/8.png" id="8_8gr2b"]
[ext_resource type="Texture2D" uid="uid://btrm8pv4oorlh" path="res://1-Idle/9.png" id="9_vl8ci"]
[ext_resource type="Texture2D" uid="uid://ci84tud32ffe8" path="res://1-Idle/10.png" id="10_ieltc"]
[ext_resource type="Texture2D" uid="uid://b7fljto3frnjw" path="res://1-Idle/11.png" id="11_fddr8"]
[ext_resource type="Texture2D" uid="uid://l0xj6edxy2we" path="res://1-Idle/12.png" id="12_oybyf"]
[ext_resource type="Texture2D" uid="uid://1ig540il8vvl" path="res://1-Idle/13.png" id="13_ajfva"]
[ext_resource type="Texture2D" uid="uid://db23fex5g5ygn" path="res://1-Idle/14.png" id="14_5ef02"]
[ext_resource type="Texture2D" uid="uid://dfm42qqqbwtyo" path="res://1-Idle/15.png" id="15_pfmca"]
[ext_resource type="Texture2D" uid="uid://cpysup1hs4vpo" path="res://1-Idle/16.png" id="16_76oay"]
[ext_resource type="Texture2D" uid="uid://dpk3b63a1ols6" path="res://1-Idle/17.png" id="17_b4uyv"]
[ext_resource type="Texture2D" uid="uid://bk35pqvvmt2lw" path="res://1-Idle/18.png" id="18_tw8ou"]
[ext_resource type="Texture2D" uid="uid://bjr21163gr7od" path="res://1-Idle/19.png" id="19_ygbnx"]
[ext_resource type="Texture2D" uid="uid://ett7eigulbqp" path="res://1-Idle/20.png" id="20_v2t6f"]
[ext_resource type="Texture2D" uid="uid://wlkgbhjmk04m" path="res://1-Idle/21.png" id="21_l3lcn"]
[ext_resource type="Texture2D" uid="uid://jr2fqgvf034r" path="res://1-Idle/22.png" id="22_xry5e"]
[ext_resource type="Texture2D" uid="uid://cbdfvgu6jnhhg" path="res://1-Idle/23.png" id="23_h6w8y"]
[ext_resource type="Texture2D" uid="uid://bx1tbufc8au8d" path="res://1-Idle/24.png" id="24_yem3p"]
[ext_resource type="Texture2D" uid="uid://d3cvi1stqo7go" path="res://1-Idle/25.png" id="25_86rna"]
[ext_resource type="Texture2D" uid="uid://bv3cnkanb8kmo" path="res://1-Idle/26.png" id="26_xg1a7"]
[ext_resource type="Texture2D" uid="uid://b8hx7p72ivg18" path="res://2-Run/1.png" id="27_ob4mi"]
[ext_resource type="Texture2D" uid="uid://dyrgsxx0wxuau" path="res://2-Run/2.png" id="28_ax26h"]
[ext_resource type="Texture2D" uid="uid://upm7op48ej7c" path="res://2-Run/3.png" id="29_kh4g0"]
[ext_resource type="Texture2D" uid="uid://dlkk838hspojy" path="res://2-Run/4.png" id="30_mgmjd"]
[ext_resource type="Texture2D" uid="uid://cgf4hjyg5leum" path="res://2-Run/5.png" id="31_va2xi"]
[ext_resource type="Texture2D" uid="uid://mcj6kdikn5t0" path="res://2-Run/6.png" id="32_fkf2u"]
[ext_resource type="Texture2D" uid="uid://c4m6l80ma80l" path="res://2-Run/7.png" id="33_s7jk6"]
[ext_resource type="Texture2D" uid="uid://b7y4dlula5mt5" path="res://2-Run/8.png" id="34_feeoa"]
[ext_resource type="Texture2D" uid="uid://cg13mto3tynf3" path="res://2-Run/9.png" id="35_m6nxt"]
[ext_resource type="Texture2D" uid="uid://trfyuj3nltvj" path="res://2-Run/10.png" id="36_ym00c"]
[ext_resource type="Texture2D" uid="uid://cbbtvhiwwst1u" path="res://2-Run/11.png" id="37_ee2o4"]
[ext_resource type="Texture2D" uid="uid://d407jl6k5unm" path="res://2-Run/12.png" id="38_vie4p"]
[ext_resource type="Texture2D" uid="uid://sl88t18c3krt" path="res://2-Run/13.png" id="39_0jj5r"]
[ext_resource type="Texture2D" uid="uid://dil5c0m7tkn7t" path="res://2-Run/14.png" id="40_77e46"]
[ext_resource type="Script" uid="uid://cmrsqkq5lictx" path="res://projetil.gd" id="42_3iwfv"]
[ext_resource type="Texture2D" uid="uid://4q7ffmv4xdav" path="res://tiro.png" id="43_qwsg1"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ibah8"]
size = Vector2(1148, 119)

[sub_resource type="GDScript" id="GDScript_ny14h"]
script/source = "extends CharacterBody2D


const SPEED = 300.0
const JUMP_VELOCITY = -400.0
@onready var  anim_walk := $AnimatedSprite2D 


func _physics_process(delta: float) -> void:
	# Add the gravity.
	if not is_on_floor():
		velocity += get_gravity() * delta

	# Handle jump.
	if Input.is_action_just_pressed(\"ui_accept\") and is_on_floor():
		velocity.y = JUMP_VELOCITY

	# Get the input direction and handle the movement/deceleration.
	# As good practice, you should replace UI actions with custom gameplay actions.
	var direction := Input.get_axis(\"ui_left\", \"ui_right\")
	if direction:
		velocity.x = direction * SPEED
		
		if anim_walk.animation != \"Walk\":
			anim_walk.play(\"Walk\")
		
		anim_walk.flip_h = direction < 0
			
	else:
		velocity.x = move_toward(velocity.x, 0, SPEED)
		
		if anim_walk.animation != \"Idle\":
			anim_walk.play(\"Idle\")

	move_and_slide()
"

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_04cqw"]
radius = 14.0
height = 48.0

[sub_resource type="SpriteFrames" id="SpriteFrames_cy2ki"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("1_331ug")
}, {
"duration": 1.0,
"texture": ExtResource("2_ny14h")
}, {
"duration": 1.0,
"texture": ExtResource("3_ibah8")
}, {
"duration": 1.0,
"texture": ExtResource("4_3iwfv")
}, {
"duration": 1.0,
"texture": ExtResource("5_qwsg1")
}, {
"duration": 1.0,
"texture": ExtResource("6_1xqrm")
}, {
"duration": 1.0,
"texture": ExtResource("7_bfour")
}, {
"duration": 1.0,
"texture": ExtResource("8_8gr2b")
}, {
"duration": 1.0,
"texture": ExtResource("9_vl8ci")
}, {
"duration": 1.0,
"texture": ExtResource("10_ieltc")
}, {
"duration": 1.0,
"texture": ExtResource("11_fddr8")
}, {
"duration": 1.0,
"texture": ExtResource("12_oybyf")
}, {
"duration": 1.0,
"texture": ExtResource("13_ajfva")
}, {
"duration": 1.0,
"texture": ExtResource("14_5ef02")
}, {
"duration": 1.0,
"texture": ExtResource("15_pfmca")
}, {
"duration": 1.0,
"texture": ExtResource("16_76oay")
}, {
"duration": 1.0,
"texture": ExtResource("17_b4uyv")
}, {
"duration": 1.0,
"texture": ExtResource("18_tw8ou")
}, {
"duration": 1.0,
"texture": ExtResource("19_ygbnx")
}, {
"duration": 1.0,
"texture": ExtResource("20_v2t6f")
}, {
"duration": 1.0,
"texture": ExtResource("21_l3lcn")
}, {
"duration": 1.0,
"texture": ExtResource("22_xry5e")
}, {
"duration": 1.0,
"texture": ExtResource("23_h6w8y")
}, {
"duration": 1.0,
"texture": ExtResource("24_yem3p")
}, {
"duration": 1.0,
"texture": ExtResource("25_86rna")
}, {
"duration": 1.0,
"texture": ExtResource("26_xg1a7")
}],
"loop": true,
"name": &"Idle",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("27_ob4mi")
}, {
"duration": 1.0,
"texture": ExtResource("28_ax26h")
}, {
"duration": 1.0,
"texture": ExtResource("29_kh4g0")
}, {
"duration": 1.0,
"texture": ExtResource("30_mgmjd")
}, {
"duration": 1.0,
"texture": ExtResource("31_va2xi")
}, {
"duration": 1.0,
"texture": ExtResource("32_fkf2u")
}, {
"duration": 1.0,
"texture": ExtResource("33_s7jk6")
}, {
"duration": 1.0,
"texture": ExtResource("34_feeoa")
}, {
"duration": 1.0,
"texture": ExtResource("35_m6nxt")
}, {
"duration": 1.0,
"texture": ExtResource("36_ym00c")
}, {
"duration": 1.0,
"texture": ExtResource("37_ee2o4")
}, {
"duration": 1.0,
"texture": ExtResource("38_vie4p")
}, {
"duration": 1.0,
"texture": ExtResource("39_0jj5r")
}, {
"duration": 1.0,
"texture": ExtResource("40_77e46")
}],
"loop": true,
"name": &"Walk",
"speed": 15.0
}]

[sub_resource type="GDScript" id="GDScript_ibah8"]
resource_name = "Controle de armas"
script/source = "extends Sprite2D


@onready var arma_sprite := $\".\"
@onready var personagem = get_parent()  # Referência ao CharacterBody2D (personagem)

@onready var projetil = $\"../../projetil\"


var arma_offset = Vector2(20, 0)  # Deslocamento inicial da arma
var ultima_direcao = 1  # 1 = direita, -1 = esquerda

var armas = {
	\"pistola\": preload(\"res://armas/pistola.png\"),
	\"kar\": preload(\"res://armas/kar.png\"),
	\"awm\" : preload(\"res://armas/awm.png\")
}

var arma_atual = null


# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	visible = false  # Começa sem arma
	atualizar_posicao()


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	if Input.is_action_just_pressed(\"atirar\"):
		print(\"atirou\")
		disparar()
		
	if Input.is_action_just_pressed(\"ui_pistola\"):
		equipar_arma(\"pistola\")
	elif Input.is_action_just_pressed(\"ui_kar\"):
		equipar_arma(\"kar\")
	elif Input.is_action_just_pressed(\"ui_awm\"):
		equipar_arma(\"awm\")
	elif Input.is_action_just_pressed(\"ui_soltar\"):
		soltar_arma()
	
	atualizar_posicao() # Atualiza a posição da arma no processo (para que a arma sempre siga o personagem)
		
func equipar_arma(nome: String):
	if nome in armas:
		texture = armas[nome]
		visible = true
		arma_atual = nome
		print(\"Arma equipada:\", nome, \" | Textura:\", texture)

func soltar_arma():
	texture = null
	visible = false
	arma_atual = null
	print(\"Arma solta\")

func atualizar_posicao():
	var direcao = 0
	if personagem.velocity.x < 0:
		direcao = -1
	elif personagem.velocity.x > 0:
		direcao = 1
	else:
		direcao = ultima_direcao
	
	ultima_direcao = direcao
	
	# Ajuste do flip e do offset com base na arma atual
	match arma_atual:
		\"pistola\":
			arma_offset.x = 30 * direcao
		\"kar\":
			arma_offset.x = 20 * direcao
		\"awm\":
			arma_offset.x = 20 * direcao
		_:
			arma_offset.x = 20 * direcao  # Padrão

	flip_h = direcao == -1
	arma_offset.y = 15
	global_position = personagem.global_position + arma_offset
	
func disparar():
	projetil.position.x = projetil.position.x * projetil.velocidade * ultima_direcao
	
"

[sub_resource type="CircleShape2D" id="CircleShape2D_ibah8"]
radius = 8.0

[node name="CenaTeste" type="Node2D"]

[node name="CHAO" type="StaticBody2D" parent="."]

[node name="CollisionShape2D" type="CollisionShape2D" parent="CHAO"]
position = Vector2(577, 588.5)
shape = SubResource("RectangleShape2D_ibah8")

[node name="Sprite2D" type="Sprite2D" parent="CHAO"]
position = Vector2(575.25, 323.75)
scale = Vector2(1.08294, 1.12653)
texture = ExtResource("1_ny14h")

[node name="JOGADOR" type="CharacterBody2D" parent="."]
position = Vector2(67, 491)
script = SubResource("GDScript_ny14h")

[node name="CollisionShape2D" type="CollisionShape2D" parent="JOGADOR"]
position = Vector2(4, 4)
shape = SubResource("CapsuleShape2D_04cqw")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="JOGADOR"]
sprite_frames = SubResource("SpriteFrames_cy2ki")
animation = &"Idle"
frame = 4
frame_progress = 0.675753

[node name="Armas" type="Sprite2D" parent="JOGADOR"]
script = SubResource("GDScript_ibah8")

[node name="projetil" type="Area2D" parent="."]
script = ExtResource("42_3iwfv")

[node name="Sprite2D" type="Sprite2D" parent="projetil"]
position = Vector2(133, 503)
texture = ExtResource("43_qwsg1")

[node name="CollisionShape2D" type="CollisionShape2D" parent="projetil"]
position = Vector2(133, 503)
shape = SubResource("CircleShape2D_ibah8")
